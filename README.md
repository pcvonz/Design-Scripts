Avert your eyes unless you want to see some ugly code ;)